<!-- If id is not exists then display message -->
<div class="flexlayout" *ngIf="!orderForm && !isInitialLoading && hasPermission">
    <div class="form_wrapper">
        <div id="no-access-form">
            <div class="top">
                <img src="assets/images/default/NoAccessImage.png" class="mb-3" alt="">
                <div class="subtitle mt-0">{{ 'ORDERS.DETAIL.MESSAGE_ORDER_NOT_EXISTS' | translate |
                    configuredEntityName}}
                </div>
            </div>
        </div>
    </div>
</div>
<div class="page-containted detail-order" *ngIf="isLoaded && orderForm && hasPermission">
    <!-- Header Start-->
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 mb-10px">
                <div class="detail-header h-100">
                    <div class="page-content card border-0 mb-0 h-100">
                        <div class="card-body p-card">
                            <div class="row vertical-center h-100">
                                <div class="col-xl col-lg-4 col-md-12 mb-3 mb-lg-0 mb-sm-4 d-flex align-self-start">
                                    <div class="float-left text-center">
                                        <div id="entity-icon" class="entity-icon">
                                            <i class="fas fa-shopping-cart" aria-hidden="true"></i>
                                        </div>
                                    </div>
                                    <div class="stage-details float-start">
                                        <p class="m-0">
                                            <span class="card-title mb-1">
                                                <label id="headingEntity">{{ 'ORDERS.DETAIL.TITLE' | translate |
                                                    configuredEntityName }}</label>
                                                <div class="overflow-box">
                                                    <strong id="nameEntity" class="pre-text">#{{orderNumber}}</strong>
                                                </div>
                                                <div class="mt-2">
                                                    {{ order.statusID }}
                                                </div>
                                                <div>
                                                    <span id="entityRating" class="mt-2 h-21 mr-2 vertical-center">
                                                        <entity-review-display [entityTypeId]="entityTypeId" [entityId]="orderId" [isFromKanbanOrListView]="false"
                                                            [isEditPermission]="isEditOrder && !order.isPaused">
                                                        </entity-review-display>
                                                    </span>
                                                    <span *ngIf="order?.entityRecordTypeName && order?.entityRecordTypeName != ''"
                                                        class="mt-2 h-21 badge badge-primary badge--status mr-2" id="badgeEntityRecordType">
                                                        {{order?.entityRecordTypeName}}
                                                    </span>
                                                    <span id="badgePaused" *ngIf="order.isPaused"
                                                      class="mt-2 h-21 badge badge-danger badge--status">
                                                      {{ order.isPaused == true ? 'Paused' : '' }}
                                                    </span>
                                                </div>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                                <div class="col-xl-8 col-lg details-section col-md-12 align-self-start">
                                    <div class="row">
                                        <div *ngIf="isEntityWorkflow && isListViewLayout"
                                            class="col-header col-xl col-lg-6 col-md-3 col-sm-4 mb-sm-3 mb-lg-3 mb-xl-0 pt-sm-3 pt-xl-0 mb-1 header-value">
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{
                                                        'ORDERS.DETAIL.STATUS' | translate }}</label>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p class="m-0"><strong id="statusOrder">{{selectedStage?.name}}</strong></p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xl col-lg-6 col-md-3 col-sm-4 mb-sm-3 mb-lg-3 mb-xl-0 pt-sm-3 pt-xl-0 mb-1 header-value">
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'ORDERS.DETAIL.ORDER_DATE' | translate | configuredEntityName }}</label>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p class="m-0" id="lblCreatedDate">
                                                        {{ order.orderDate | date }}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xl col-lg-6 col-md-3 col-sm-4 mb-sm-3 mb-lg-3 mb-xl-0 pt-sm-3 pt-xl-0 mb-1 header-value">
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'ORDERS.DETAIL.ASSIGNEE' | translate }}</label>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p class="m-0 pre-text">{{ order.assignedToName }}</p>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-xl col-lg-6 col-md-3 col-sm-4 mb-sm-3 mb-lg-3 mb-xl-0 pt-sm-3 pt-xl-0 mb-1 header-value">
                                            <div *ngIf="isEntityWorkflow" class="row mb-1 mb-sm-2">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'ORDERS.DETAIL.TOTAL_SPENT_TIME' | translate }}</label>
                                                    <i class="fas fa-info-circle dark-grey ml-1 info-tooltip" tooltipClass="custom-tooltip-class" [ngbTooltip]="('ORDERS.DETAIL.TOLLTIP_DURATION' | translate).replace('[[hoursInDay]]',hoursInDay)" placement="top top-left" container="body" aria-hidden="true"></i>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p-skeleton *ngIf="!totalSpentTime; else showTotalSpentTime" width="8rem"></p-skeleton>
                                                    <ng-template #showTotalSpentTime>
                                                        <p class="m-0" id="lblTotalSpentTime">
                                                            {{ totalSpentTime }}
                                                        </p>
                                                    </ng-template>
                                                </div>
                                            </div>
                                            <div *ngIf="isEntityWorkflow" class="row mb-1 mb-sm-2">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'ORDERS.DETAIL.TOTAL_EFFECTIVE_TIME' | translate }}</label>
                                                    <i class="fas fa-info-circle dark-grey ml-1 info-tooltip" tooltipClass="custom-tooltip-class" [ngbTooltip]="('ORDERS.DETAIL.TOLLTIP_DURATION' | translate).replace('[[hoursInDay]]',hoursInDay)" placement="top top-left" container="body" aria-hidden="true"></i>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p-skeleton *ngIf="!totalEffectiveTime; else showTotalEffectiveTime" width="8rem"></p-skeleton>
                                                    <ng-template #showTotalEffectiveTime>
                                                        <p class="m-0" id="lblTotalEffectiveTime">
                                                            {{ totalEffectiveTime }}
                                                        </p>
                                                    </ng-template>
                                                </div>
                                            </div>
                                            <div *ngIf="isEntityWorkflow" class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'ORDERS.DETAIL.TOTAL_PAUSE_TIME' | translate }}</label>
                                                    <i class="fas fa-info-circle dark-grey ml-1 info-tooltip" tooltipClass="custom-tooltip-class" [ngbTooltip]="('ORDERS.DETAIL.TOLLTIP_DURATION' | translate).replace('[[hoursInDay]]',hoursInDay)" placement="top top-left" container="body" aria-hidden="true"></i>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p-skeleton *ngIf="!totalPauseTime; else showTotalPauseTime" width="8rem"></p-skeleton>
                                                    <ng-template #showTotalPauseTime>
                                                        <p class="m-0" id="lblTotalPauseTime">
                                                            {{ totalPauseTime }}
                                                        </p>
                                                    </ng-template>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="back-arrow col-lg">
                                    <div class="row">
                                        <div class="col-12">
                                            <button id="btn-back" class='btn btn-secondary mb-12px' type='button'
                                                (click)="backToList()">
                                                {{ 'ORDERS.DETAIL.BUTTON_BACK' | translate }}
                                            </button>
                                        </div> 
                                        <div *ngIf="isEditOrder && isAllowToReopen && !order?.isPaused && (isCompleted || isClosed)" class="col-12">
                                            <div class="dropdown">
                                              <button class="btn btn-primary dropdown-toggle btn-action" type="button" id="dropdownActionMenu"
                                                data-bs-toggle="dropdown" aria-expanded="false">
                                                {{ 'ORDERS.DETAIL.BUTTON_ACTION' | translate }}
                                              </button>
                                              <div class="dropdown-menu" aria-labelledby="dropdownActionMenu">
                                                <a id="link-stage-reopen" (click)="onReopenStage()" class="dropdown-item menu--item">
                                                    <i class="fa-regular fa-folder-open me-1"></i>
                                                  {{ 'ORDERS.DETAIL.ACTION_TITLE_STAGE_REOPEN' | translate }}
                                                </a>
                                              </div>
                                            </div>
                                          </div>
                                    </div>
                                </div>
                                <div class="col-xl-12 col-lg-12 align-self-end align-tags top-margin-tags">
                                    <div class="vertical-bottom flex-nowrap justify-content-between">
                                        <entity-tags-view [refreshEntityTag]="refreshEntityTag" [entityId]="orderId"
                                            [entityTypeId]="entityTypeId" [entityRecordTypeId]="entityRecordTypeID">
                                        </entity-tags-view>
                                        <div class="pt-3 pl-3 pe-2 d-flex bookmark-icon">
                                            <ngx-bookmark [entityTypeId]="entityTypeId" [entityId]="orderId" [isEditPermission]="isEditOrder && !order.isPaused"
                                                class="font-18" [isFromKanbanOrListView]="false">
                                            </ngx-bookmark>
                                            <div *ngIf="order.isShowPauseOrResume && !isCompleted && !isClosed">
                                                <i *ngIf="order.isPaused && (this._loggedInUser.userId == order.assignedTo || isResumeRecord)"
                                                    class="far fa-play-circle font-18 dark-grey cursor-pointer ms-3" tooltipClass="tooltip-backward-small"
                                                    [ngbTooltip]="'ORDERS.DETAIL.TOOLTIP_RESUME'| translate" id="resumeButton" container="body"
                                                    (click)="onOrderStagePauseChanged(order, false)"></i>
                                                <i *ngIf="!isEditOrder && order.isPaused && (this._loggedInUser.userId != order.assignedTo && !isResumeRecord)"
                                                    class="far fa-play-circle font-18 dark-grey cursor-pointer ms-3" tooltipClass="tooltip-backward-small"
                                                    [ngbTooltip]="'ORDERS.DETAIL.MESSAGE_RESUME_NOT_ACCESS'| translate" id="resumeButtonNotAccess"
                                                    container="body"></i>
                                                <i *ngIf="isEditOrder && !order.isPaused && (this._loggedInUser.userId == order.assignedTo || isResumeRecord)"
                                                    class="far fa-pause-circle font-18 dark-grey cursor-pointer ms-3" tooltipClass="tooltip-backward-small"
                                                    [ngbTooltip]="'ORDERS.DETAIL.TOOLTIP_PAUSE'| translate" id="pauseButton" container="body"
                                                    (click)="onOrderStagePauseChanged(order, true)"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div> 
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Header End-->

    <!-- Stages Start-->
    <div *ngIf="isEntityWorkflow && !isListViewLayout" class="page-content container-fluid stage-process">
        <div class="con_scroll d-none d-lg-block d-md-block d-sm-none d-xs-none">
            <div class="btn-group btn-group-toggle arrow-steps mb-10px" data-toggle="buttons" #menuContent>
                <button type="button" class="btn btn-secondary btn--arrow" *ngFor="let stage of orderStages" id="btnStatusChange" triggers="hover" tooltipClass="tooltip-backward-small"
                    placement="top bottom" [ngbTooltip]="stage.name" container="body" [disabled]="!isEditOrder || order.isPaused || isCompleted || isClosed"
                    class="{{ 'btn btn-secondary btn--arrow ' + (stage | stageCss: currentStage) }}"
                    (click)="onMarkStageAsComplete(stage.id)">
                    <input type="radio" [name]="stage.name" autocomplete="off">
                    <span class="btn_name">{{ stage.name }}</span>
                </button>
            </div>
        </div>
        
        <div class="d-lg-none d-md-none d-sm-block d-xs-block py-2">
            <label>{{ 'ORDERS.DETAIL.STAGE_TITLE' | translate }}</label>
            <p-dropdown id="drp-StatusChange" class="form-control mb-2" [disabled]="!isEditOrder || order.isPaused || isCompleted || isClosed" 
                [options]="orderStages" [(ngModel)]="selectedStage" (onChange)="onMarkStageAsComplete($event.value.id)">
                <ng-template let-stage pTemplate="selectedItem">
                    <div>{{stage.name}}</div>
                </ng-template>
                <ng-template let-stage pTemplate="item">
                        <div>{{stage.name}}</div>
                </ng-template>
            </p-dropdown>
        </div>
    </div>
    <!-- Stages Start-->

    <!-- Body Start-->
    <div class="page-content container-fluid pr-0">
        <div class="row h---100vh w-100">
            <div class="col col-xl-8 col-lg-12 mb-xl-0 mb-2 pr-0 details-box">
                <!-- nav Tab Menu Start -->
                <div class="navTabs card-bottom-border border-0 p-card">
                    <div class="row width--100 border-bottom m-0 first-tabs">
                        <!-- Tab Section here -->
                       <ng-container>
                        <ngx-globle-nav-tab [navTabs]="navTabs" [isNativeTab]="isNativeTab"  (setTab)="checkTabCall($event,1)"
                            class="col tabs-mobile p-0" (closeTab)="closeNavTab($event)"
                            [ngClass]="{'edit-icon-section': isReadOnly && !(['navWorkTasks', 'navContacts', 'navAttachment', 'navProducts', 'navHistory', 'additionalTabs','navDocuments'] | showHidePencilButton: activeTab)}"></ngx-globle-nav-tab>
                        </ng-container>
						
                    
                        <div class="col-auto edit-form-icon px-0">
                            <div *ngIf="isEditOrder && !order.isPaused && !isCompleted && !isClosed">
                                <i class="fas fa-pencil-alt pencil-icon fa-lg clr-blue float-right cursor-pointer"
                                    aria-hidden="true" id="btnEditTabDetail" (click)="showHideDetailTab('EDIT')"
                                    *ngIf="isReadOnly && !(['navOrderCustomers', 'navOrderItems', 'navOrderStageHistory', 'navHistory','additionalTabs','navDocuments'] | showHidePencilButton: activeTab)"></i>
                            </div>
                            <!-- Global save and cancel start -->
                            <div class="form-update-icons" *ngIf="!isReadOnly && !(['navOrderCustomers', 'navOrderItems', 'navOrderStageHistory', 'navHistory','additionalTabs','navDocuments'] | showHidePencilButton: activeTab)">
                                <i id="btn-cancel" *ngIf="isEditOrder && !order.isPaused && !isCompleted && !isClosed"
                                    class="fas fa-times fa-lg dark-grey float-right mr-3"
                                    (click)="showHideDetailTab('CANCEL')" aria-hidden="true"></i>
                                <i *ngIf="isEditOrder && !order.isPaused && !isCompleted && !isClosed" id="btn-save"
                                    class="fas fa-check fa-lg clr-blue float-right" (click)="showHideDetailTab('SAVE')" aria-hidden="true"></i>
                            </div>
                            <!-- Global save and cancel end -->
                        </div>
                    </div>

                    <!-- Tab Content Start -->
                    <form [hidden]="isAdditionalTab" [formGroup]="orderForm">
                        <div class="tab-content border-0 mt-0" id="orderDetailTabContent">
                            <!-- Details Start-->
                            <div class="tab-pane fade px-0 p-0" id="navDetails" role="tabpanel" [ngClass]="selectedTab == 'navDetails' ? 'show active' : ''"
                                aria-labelledby="navDetails-tab" name="navDetails">

                                <!-- Basic Information Start-->
                                <div class="card border-0 m-0 pt-md-0 pt-3">
                                    <div class="card-header btn-card-edit py-0">
                                        <span class="vertical-center py-md-3 pt-0 pb-3 line-height-1">
                                            {{'ORDERS.DETAIL.TAB_DETAILS.BASIC_INFO' | translate }}
                                        </span>
                                    </div>
                                    <div class='card-body'>
                                        <div class='row'>
                                            <div class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.ORDER_NUMBER' | translate | configuredEntityName}}
                                                    <span class="mandatory"></span>
                                                </label>
                                                <div *ngIf="isReadOnly" class="disable-text pre-text">{{ order.orderNumber ? order.orderNumber : '&nbsp;' }}</div>
                                                <input #orderTxtNumber *ngIf="!isReadOnly" id="txt-orderNumber"
                                                    type="text" class="form-control" formControlName="orderNumber"
                                                    [(ngModel)]="order.orderNumber" trimValue
                                                    [ngClass]="{ 'is-invalid': orderfrm.orderNumber.errors && (orderfrm.orderNumber.dirty || orderfrm.orderNumber.touched)}"
                                                    trimValue>
                                                <div *ngFor='let validation of orderValidationMessages.orderNumber'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.orderNumber.hasError(validation.type) && orderfrm.orderNumber.errors && (orderfrm.orderNumber.dirty || orderfrm.orderNumber.touched)'
                                                        id="errororderNumberIsRequired">
                                                        {{ validation.message | translate | configuredEntityName}}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.ORDER_DATE' | translate | configuredEntityName}}
                                                </label>
                                                <div *ngIf="isReadOnly" class="disable-text">
                                                    {{ order.orderDate == null ? '&nbsp;' : order.orderDate |
                                                    dateFormatPipe: _commonHelper.globalDateFormate }}
                                                </div>
                                                <p-calendar *ngIf="!isReadOnly" id="dp-orderDate" class="time-calendar"
                                                    formControlName="orderDate"
                                                    [dateFormat]="_commonHelper.globalDatePickerFormate"
                                                    [placeholder]="_commonHelper.globalDatePlaceholder"
                                                    [dateMask]="_commonHelper.globalDateMask" [readonlyInput]="false"
                                                    icon="fas fa-calendar-alt dark-grey" [showIcon]="true"
                                                    [monthNavigator]="true" [yearNavigator]="true" [showTime]="false"
                                                    [minDate]="_commonHelper.globalMinDate" [maxDate]="todaysDate" selectOtherMonths="true"
                                                    [yearRange]="currentYearRange" [(ngModel)]="order.orderDate"
                                                    (onSelect)="onSelectDate()">
                                                </p-calendar>
                                                <div *ngFor='let validation of orderValidationMessages.orderDate'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.orderDate.hasError(validation.type) &&   orderfrm.orderDate.errors'
                                                        id="errorBirthDateMustBeValidBirthDate">
                                                        {{ validation.message | translate | configuredEntityName}}
                                                    </div>
                                                </div>
                                            </div>
                                        
                                            <div class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.AMOUNT' | translate }} <span
                                                        class="mandatory"></span>
                                                </label>
                                                <div class="inner-addon left-addon">
                                                    <div *ngIf="isReadOnly" class="disable-text">
                                                        <div
                                                            *ngIf="(order.totalAmount != null && order.totalAmount != undefined ) else totalAmount">
                                                            {{(currencySymbol)+(order.totalAmount | number:'1.2-2') }}
                                                        </div>
                                                        <ng-template #totalAmount>
                                                            <div>&nbsp;</div>
                                                        </ng-template>
                                                    </div>
                                                </div> 
                                                <div class="inner-addon left-addon" *ngIf="!isReadOnly">
                                                    <span>{{currencySymbol}}</span>
                                                    <input id="txt-totalAmount" type="text" class="form-control ht--40"
                                                        name="totalAmount" formControlName="totalAmount"
                                                        [(ngModel)]="order.totalAmount" mask="separator.2"
                                                        thousandSeparator="," maxlength="18"
                                                        [ngClass]="{ 'is-invalid': orderfrm.totalAmount.errors && (orderfrm.totalAmount.dirty || orderfrm.totalAmount.touched)}">

                                                    <div *ngFor='let validation of orderValidationMessages.totalAmount'
                                                        class='invalid-feedback '>
                                                        <div *ngIf='orderfrm.totalAmount.hasError(validation.type) && orderfrm.totalAmount.errors && (orderfrm.totalAmount.dirty || orderfrm.totalAmount.touched)'
                                                            id="errortotalAmountMustBeValidNumber">
                                                            {{ validation.message | translate }}
                                                        </div>
                                                    </div>
                                                </div>

                                            </div>
                                            <!-- <div class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.ORDER_TYPE' | translate | configuredEntityName}}
                                                </label>
                                                <div class="disable-text" [ngClass]="{ 'min-height-38px': (!isReadOnly) }">
                                                    {{ (orderTypes | displayValueFinder:
                                                    {id:order.entityRecordTypeID})?.length
                                                    ?
                                                    ( orderTypes | displayValueFinder:
                                                    {id:order.entityRecordTypeID})[0].name : ' ' }}
                                                </div>
                                                <div *ngFor='let validation of orderValidationMessages.entityRecordTypeID'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.entityRecordTypeID.hasError(validation.type) &&  orderfrm.entityRecordTypeID.errors'
                                                        id="errorEntityRecordTypeIDMustBeValid">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.ORDER_SUB_TYPE' | translate | configuredEntityName}}
                                                </label>
                                                <div class="disable-text" *ngIf="isReadOnly">
                                                    {{ (orderSubTypes | displayValueFinder:
                                                    {id:order.entityRecordSubTypeID})?.length
                                                    ?
                                                    ( orderSubTypes | displayValueFinder:
                                                    {id:order.entityRecordSubTypeID})[0].name : ' ' }}
                                                </div>
                                                <p-dropdown *ngIf="!isReadOnly" id="drp-entityRecordSubTypeID"
                                                    class="form-control" formControlName="entityRecordSubTypeID"
                                                    [filter]="true" [resetFilterOnHide]="false" [showClear]="true"
                                                    [options]="orderSubTypes"
                                                    placeholder="{{'ORDERS.DETAIL.TAB_DETAILS.ORDER_SUB_TYPE' | translate| configuredEntityName}}"
                                                    optionLabel="name" optionValue="id" name="entityRecordSubTypeID"
                                                    [(ngModel)]="order.entityRecordSubTypeID">
                                                </p-dropdown>
                                                <div *ngFor='let validation of orderValidationMessages.entityRecordSubTypeID'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.entityRecordSubTypeID.hasError(validation.type) &&  orderfrm.entityRecordSubTypeID.errors'
                                                        id="errorEntityRecordTypeIDMustBeValid">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div> -->

                                            <div *ngIf="isEntityWorkflow" class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.ASSIGNEE' | translate }}
                                                </label>
                                                <ng-container *ngIf="isReadOnly || !isAssignOrder; else TemplateDrpAssignedTo">
                                                    <div class="disable-text pre-text">{{ order.assignedToName != null && order.assignedToName != '' ?
                                                        order.assignedToName : '' }}</div>
                                                </ng-container>
                                                <ng-template #TemplateDrpAssignedTo>
                                                    <!-- Assigned To Loading Bar -->
                                                    <ngx-control-level-loading-bar *ngIf="showAssignedToLoader"></ngx-control-level-loading-bar>
                                                    <p-dropdown *ngIf="!isReadOnly" id="drp-assignee" class="form-control" formControlName="assignedTo" [filter]="true"
                                                        [resetFilterOnHide]="false" [showClear]="true" [options]="assignedToUsers"
                                                        (onFilter)="assignedToOnFilter($event)" (onChange)="assignedToOnChange($event)"
                                                        placeholder="{{'ORDERS.DETAIL.TAB_DETAILS.ASSIGNEE' | translate}}" optionLabel="label" optionValue="value"
                                                        name="assignedTo" [(ngModel)]="order.assignedTo">
                                                    </p-dropdown>
                                                    <div *ngFor='let validation of orderValidationMessages.assignedTo' class='invalid-feedback'>
                                                        <div *ngIf='orderfrm.assignedTo.hasError(validation.type) &&  orderfrm.assignedTo.errors'
                                                            id="errorEntityRecordTypeIDMustBeValid">
                                                            {{ validation.message | translate }}
                                                        </div>
                                                    </div>
                                                </ng-template>
                                            </div>

                                            <div class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.DELIVERY_DATE' | translate }}
                                                </label>
                                                <div *ngIf="isReadOnly" class="disable-text">
                                                    {{ order.deliveryDate == null ? '&nbsp;' : order.deliveryDate |
                                                    dateFormatPipe: _commonHelper.globalDateFormate }}
                                                </div>
                                                <p-calendar *ngIf="!isReadOnly" id="dp-deliveryDate"
                                                    class="time-calendar" formControlName="deliveryDate"
                                                    [dateFormat]="_commonHelper.globalDatePickerFormate"
                                                    [placeholder]="_commonHelper.globalDatePlaceholder"
                                                    [dateMask]="_commonHelper.globalDateMask" [readonlyInput]="false"
                                                    icon="fas fa-calendar-alt dark-grey" [showIcon]="true"
                                                    [monthNavigator]="true" [yearNavigator]="true" [showTime]="false" 
                                                    [minDate]="_commonHelper.globalMinDate" [maxDate]="todaysDate" selectOtherMonths="true"
                                                    [yearRange]="currentYearRange" [(ngModel)]="order.deliveryDate"
                                                    (onSelect)="onSelectDate()"
                                                    [ngClass]="{ 'is-invalid': orderfrm.deliveryDate.errors && (orderfrm.deliveryDate.dirty || orderfrm.deliveryDate.touched)}">
                                                </p-calendar>
                                                <div *ngFor='let validation of orderValidationMessages.deliveryDate'
                                                    class='invalid-feedback invalid-text'>
                                                    <div *ngIf='orderfrm.deliveryDate.hasError(validation.type) &&   orderfrm.deliveryDate.errors'
                                                        id="errorDeliveryDateMustBeGreaterThanOrderDate">
                                                        {{ validation.message | translate | configuredEntityName}}
                                                    </div>
                                                </div>
                                            </div>

                                            <div class='col-md-4 col-sm-6 form-group'>
                                                <label>{{'ORDERS.DETAIL.TAB_DETAILS.DISCOUNT_TYPE' | translate}}</label>
                                                <div class="disable-text" *ngIf="isReadOnly">
                                                    {{ (discountTypeList | displayValueFinder:
                                                    {intValue1:order.discountType})?.length
                                                    ?
                                                    ( discountTypeList | displayValueFinder:
                                                    {intValue1:order.discountType})[0].name : ' ' }}
                                                </div>
                                                <p-dropdown *ngIf="!isReadOnly" id="drp-discountType"
                                                    class="form-control" formControlName="discountType" [filter]="true"
                                                    [resetFilterOnHide]="false" [showClear]="true"
                                                    [options]="discountTypeList"
                                                    placeholder="{{'ORDERS.DETAIL.TAB_DETAILS.DISCOUNT_TYPE_PLACEHOLDER' | translate}}"
                                                    optionLabel="name" optionValue="intValue1"
                                                    [(ngModel)]="order.discountType"
                                                    (onChange)="changeDiscountType($event.value)">
                                                </p-dropdown>
                                                <div *ngFor='let validation of orderValidationMessages.discountType'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderForm.discountType.hasError(validation.type) &&   orderForm.discountType.errors'
                                                        id="errorDiscountTypeMustBeValidDiscountType">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>

                                            <div class='col-md-4 col-sm-6 form-group'
                                                *ngIf="selectedDiscountType == 'Percentage'">
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.DISCOUNT_PERCENTAGE' | translate }}
                                                </label>
                                                <div *ngIf="isReadOnly" class="disable-text view-icon-alignment">
                                                    <span>{{ order.discountRate ? order.discountRate : '&nbsp;'
                                                        }}</span>
                                                    <span>%</span>
                                                </div>
                                                <div *ngIf="!isReadOnly" class="inner-addon right-addon">
                                                    <span>%</span>
                                                    <input id="txt-discountPercentage" type="text" class="form-control"
                                                        formControlName="discountRate" [(ngModel)]="order.discountRate" 
                                                        trimValue mask="separator.2" thousandSeparator=","
                                                        [ngClass]="{ 'is-invalid': orderfrm.discountRate.errors && (orderfrm.discountRate.dirty || orderfrm.discountRate.touched)}">
                                                </div>
                                                <div *ngFor='let validation of orderValidationMessages.discountRate'
                                                    class='invalid-feedback  invalid-text'>
                                                    <div *ngIf='orderfrm.discountRate.hasError(validation.type) && orderfrm.discountRate.errors && (orderfrm.discountRate.dirty || orderfrm.discountRate.touched)'
                                                        id="errordiscountRateIsRequired">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>



                                            <div class='col-md-4 col-sm-6 form-group'
                                                *ngIf="selectedDiscountType == 'Amount'">
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.DISCOUNT_AMOUNT' | translate }}
                                                </label>
                                                <div class="inner-addon left-addon">
                                                    <div *ngIf="isReadOnly" class="disable-text view-icon-alignment">
                                                        <div
                                                            *ngIf="(order.discountAmount != null && order.discountAmount != undefined  ) else blankTotalAmount">
                                                            {{(currencySymbol)+(order.discountAmount | number:'1.2-2')
                                                            }}
                                                        </div>
                                                        <ng-template #blankTotalAmount>
                                                            <div>&nbsp;</div>
                                                        </ng-template>
                                                    </div>
                                                </div>
                                                <div class="inner-addon left-addon" *ngIf="!isReadOnly">
                                                    <span>{{currencySymbol}}</span>
                                                    <input id="txt-discountAmount" type="text" maxlength="18"
                                                        class="form-control ht--40" name="discountAmount"
                                                        formControlName="discountAmount"
                                                        [(ngModel)]="order.discountAmount" mask="separator.2"
                                                        thousandSeparator=","
                                                        [ngClass]="{ 'is-invalid': orderfrm.discountAmount.errors && (orderfrm.discountAmount.dirty || orderfrm.discountAmount.touched)}">
                                                    <div *ngFor='let validation of orderValidationMessages.discountAmount'
                                                        class='invalid-feedback'>
                                                        <div *ngIf='orderfrm.discountAmount.hasError(validation.type) && orderfrm.discountAmount.errors && (orderfrm.discountAmount.dirty || orderfrm.discountAmount.touched)'
                                                            id="errorPriceMustBeValidNumber">
                                                            {{ validation.message | translate }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.SHIPPING_METHOD' | translate }}
                                                </label>
                                                <div class="disable-text" *ngIf="isReadOnly">
                                                    {{ (shippingMethods | displayValueFinder:
                                                    {id:order.shippingMethodID})?.length ? ( shippingMethods |
                                                    displayValueFinder: {id:order.shippingMethodID})[0].name : ' ' }}
                                                </div>
                                                <p-dropdown *ngIf="!isReadOnly" id="drp-shippingMethod"
                                                    class="form-control" formControlName="shippingMethodID"
                                                    [filter]="true" [resetFilterOnHide]="false" [showClear]="true"
                                                    [options]="shippingMethods"
                                                    placeholder="{{'ORDERS.DETAIL.TAB_DETAILS.SHIPPING_METHOD' | translate}}"
                                                    optionLabel="name" optionValue="id" name="shippingMethodID"
                                                    [(ngModel)]="order.shippingMethodID">
                                                </p-dropdown>
                                                <div *ngFor='let validation of orderValidationMessages.assignedTo'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.assignedTo.hasError(validation.type) &&   orderfrm.assignedTo.errors'
                                                        id="errorEntityRecordTypeIDMustBeValid">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>


                                            <div *ngIf="isEntityWorkflow" class='col-md-4 col-sm-6 form-group'>
                                                <label>{{ 'ORDERS.DETAIL.TAB_DETAILS.PRIORITY' | translate }}</label>
                                                <div *ngIf="isReadOnly" class="disable-text">
                                                    {{
                                                    order.priorityName != null && order.priorityName != '' ?
                                                    order.priorityName : ''
                                                    }}
                                                </div>

                                                <p-dropdown *ngIf="!isReadOnly" id="drp-priorityIDs" class="form-control"
                                                    formControlName="priority" [filter]="true"
                                                    [resetFilterOnHide]="false" [showClear]="true"
                                                    [options]="priorityList"
                                                    placeholder="{{'ORDERS.DETAIL.TAB_DETAILS.PRIORITY_PLACE_HOLDER' | translate}}"
                                                    optionLabel="label" optionValue="value" name="priority"
                                                    [(ngModel)]="order.priority">
                                                </p-dropdown>
                                                <div *ngFor='let validation of orderValidationMessages.priority'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.entityRecordSubTypeID.hasError(validation.type) &&  orderfrm.entityRecordSubTypeID.errors'
                                                        id="errorpriorityMustBeValid">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>

                                            <div *ngIf="isEntityWorkflow" class='col-md-4 col-sm-6 form-group'>
                                                <label>{{ 'ORDERS.DETAIL.TAB_DETAILS.SEVERITY' | translate }}</label>
                                                <div *ngIf="isReadOnly" class="disable-text">
                                                    {{
                                                    order.severityName != null && order.severityName != '' ?
                                                    order.severityName : ''
                                                    }}
                                                </div>
                                                <p-dropdown *ngIf="!isReadOnly" id="drp-severityIDs" class="form-control"
                                                    formControlName="severity" [filter]="true"
                                                    [resetFilterOnHide]="false" [showClear]="true"
                                                    [options]="severityList"
                                                    placeholder="{{'ORDERS.DETAIL.TAB_DETAILS.SEVERITY_PLACE_HOLDER' | translate}}"
                                                    optionLabel="label" optionValue="value" name="severity"
                                                    [(ngModel)]="order.severity">

                                                </p-dropdown>
                                                <div *ngFor='let validation of orderValidationMessages.severity'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.entityRecordSubTypeID.hasError(validation.type) &&  orderfrm.entityRecordSubTypeID.errors'
                                                        id="errorSeverityMustBeValid">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>



                                            <div *ngIf="isEntityWorkflow && !isListViewLayout" class='col-md-4 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.TASKS' | translate }}
                                                </label>
                                                <div *ngIf="isReadOnly && currentStageTask != null"
                                                    class="disable-text">
                                                    {{
                                                        currentStageTask && currentStageTask.length > 0
                                                        ? (order.selectedStageTaskIds?.length ?? 0) + ' of ' + currentStageTask.length + '
                                                        completed' : ''
                                                    }}

                                                </div>
                                                <div *ngIf="isReadOnly && (currentStageTask == undefined || currentStageTask == null)"
                                                    class="disable-text">
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.NO_TASKS' | translate }}
                                                </div>

                                                <div *ngIf="!isReadOnly && currentStageTask != null"
                                                    class="input-group entity-dropdown custom-dropdown-muliselect">
                                                    <p-multiSelect [options]="currentStageTask" id="drp-tasks"
                                                        class="entity-multiSelect" optionLabel="name"
                                                        formControlName="selectedStageTaskIds"
                                                        [(ngModel)]="order.selectedStageTaskIds"
                                                        [maxSelectedLabels]="500" [showToggleAll]="false"
                                                        [filter]="false" [showHeader]="false"
                                                        [displaySelectedLabel]='false'
                                                        [defaultLabel]="currentStageTask && currentStageTask.length > 0
                                                    ? (order.selectedStageTaskIds?.length ?? 0) + ' of ' + currentStageTask.length + ' completed' : ''">
                                                    </p-multiSelect>
                                                </div>
                                                <div class="min-height-38px disable-text"
                                                    *ngIf="!isReadOnly && (currentStageTask == null || currentStageTask == '')">
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.NO_TASKS' | translate }}
                                                </div>
                                            </div>

                                            <div class='col-md-4 col-sm-6 form-group' *ngIf="isEntityWorkflow && isListViewLayout">
                                                <label>{{'ORDERS.DETAIL.TAB_DETAILS.STATUS' | translate}} <span class="mandatory"></span></label>
                                                <div class="disable-text" *ngIf="isReadOnly">
                                                    {{ (orderStages | displayValueFinder: {id:order.entityStageId})?.length
                                                    ?
                                                    (orderStages | displayValueFinder: {id:order.entityStageId})[0].name : ' ' }}
                                                </div>
                                                <p-dropdown *ngIf="!isReadOnly" id="drp-stageId" class="form-control" formControlName="entityStageId"
                                                    [filter]="true" [resetFilterOnHide]="false" [options]="orderStages"
                                                    placeholder="{{'ORDERS.DETAIL.TAB_DETAILS.STATUS_PLACEHOLDER' | translate}}" optionLabel="name"
                                                    optionValue="id" [(ngModel)]="order.entityStageId"
                                                    [ngClass]="{ 'is-invalid': submitted && orderfrm.entityStageId.errors }">
                                                </p-dropdown>
                                                <div *ngFor='let validation of orderValidationMessages.entityStageId' class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.entityStageId.hasError(validation.type) && orderfrm.entityStageId.errors'
                                                        id="errorStageIsRequired">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>

                                            <div class='col-xl-12 form-group'>
                                                <label>
                                                    {{ 'ORDERS.DETAIL.TAB_DETAILS.DESSCRIPTION' | translate }}
                                                </label>
                                                <div *ngIf="isReadOnly" class="disable-text">
                                                    {{ order.description ? order.description : '&nbsp;' }}
                                                </div>
                                                <textarea *ngIf="!isReadOnly" id="txt-description"
                                                    formControlName="description" class="form-control ht--40"
                                                    name="description" rows="6" trimValue
                                                    [(ngModel)]="order.description"
                                                    [ngClass]="{ 'is-invalid': orderfrm.description.errors && (orderfrm.description.dirty || orderfrm.description.touched)}">
                                                </textarea>
                                                <div *ngFor='let validation of orderValidationMessages.description'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='orderfrm.description.hasError(validation.type) && orderfrm.description.errors && (orderfrm.description.dirty || orderfrm.description.touched)'
                                                        id="errorDescriptionIsRequired">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Details End-->


                            <!-- Custom Start-->
                            <div class="tab-pane fade px-0 pt-0" [ngClass]="selectedTab == ('nav' + tab.tabName | removeWhiteSpace) ? 'show active' : ''"
                                *ngFor="let tab of formDataJSON; let i = index" id="{{ 'nav' + tab.tabName | removeWhiteSpace }}" name="navCustom"
                                role="tabpanel" aria-labelledby="navCustom-tab">
                                <!-- Section Start-->
                                <div class='card border-0 m-0 pt-md-0 pt-3'
                                    *ngFor="let section of tab.sections; let j = index">
                                    <div class="card-header btn-card-edit py-0">
                                        <span *ngIf="section.sectionName" class="vertical-center py-md-3 pt-0 pb-3 line-height-1">
                                            {{ section.sectionName }}
                                        </span>
                                    </div>
                                    <div class='card-body'>
                                        <div class='row'>
                                            <ngx-custom-field [formGroup]="orderForm" [section]="section" [controls]="section.controls"
                                                [customFieldJSONData]="order.customFieldJSONData" [isReadOnly]="isReadOnly" [submitted]="submitted"
                                                [currencySymbol]="currencySymbol" [refreshTabularDataSource]="refreshCustomFieldDatasource"
                                                [entityID]="orderId" [entityTypeID]="entityTypeId" [entityRecordTypeID]="entityRecordTypeID"></ngx-custom-field>
                                        </div>
                                    </div>
                                </div>
                                <!-- Section End-->
                            </div>
                            <!-- Custom End-->

                            <!-- Customer Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navOrderCustomers" role="tabpanel" [ngClass]="selectedTab == 'navOrderCustomers' ? 'show active' : ''"
                                aria-labelledby="navOrderItems-tab" name="navCustomer">
                                <ng-container>
                                    <div class="card border-0 m-0 px-0 pt-0">
                                        <div class='card-body pt-0'>
                                            <div class='row'>
                                                <div class='col-lg-6 col-sm-12 form-group'>
                                                    <label>{{ 'ORDERS.DETAIL.TAB_CUSTOMER.CUSTOMERNAME' | translate }}</label>
                                                    <div class="disable-text">
                                                        {{
                                                            order.billToAccountName ? (order.billToAccountName + '/') : ''
                                                        }}
                                                        {{
                                                        order.billToContactName ? order.billToContactName : ''
                                                        }}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="card border-0 m-0 px-0">
                                                        <div class="card-header btn-card-edit  pt-0">
                                                            {{'ORDERS.DETAIL.TAB_CUSTOMER.BILLING_ADDRESS_INFO.TITLE' |
                                                            translate}}
                                                        </div>
                                                        <div class='card-body'>
                                                            <div class="row">
                                                                <div class="col-lg-12">
                                                                    <div class='row'>
                                                                        <div class='col-md-12 form-group'>
                                                                            <label>
                                                                                {{'ORDERS.DETAIL.TAB_CUSTOMER.BILLING_ADDRESS_INFO.ADDRESS' | translate}}</label>
                                                                            <div class="disable-text">
                                                                                {{ order.billingAddress1 != null && order.billingAddress1 != '' ? order.billingAddress1 : ' ' }}
                                                                                
                                                                                {{ order.billingAddress2 != null && order.billingAddress2 != '' ? ", " + order.billingAddress2 : ' ' }}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class='row'>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.BILLING_ADDRESS_INFO.CITY' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ order.billingCity != null && order.billingCity != '' ? order.billingCity : ' ' }}
                                                                    </div>
                                                                </div>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.BILLING_ADDRESS_INFO.STATE' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ (billingStates | displayValueFinder:
                                                                        {value:order.billingStateID})?.length
                                                                        ?
                                                                        ( billingStates | displayValueFinder:
                                                                        {value:order.billingStateID})[0].label
                                                                        :' ' }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class='row'>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.BILLING_ADDRESS_INFO.ZIPCODE' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ order.billingPostalCode != null && order.billingPostalCode != '' ? order.billingPostalCode : ' ' }}
                                                                    </div>
                                                                </div>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.BILLING_ADDRESS_INFO.COUNTRY' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ (countries | displayValueFinder:
                                                                        {id:order.billingCountryID})?.length
                                                                        ?
                                                                        ( countries | displayValueFinder:
                                                                        {id:order.billingCountryID})[0].name
                                                                        :' ' }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="card border-0 m-0 px-0">
                                                        <div class="card-header btn-card-edit  pt-0">
                                                            {{'ORDERS.DETAIL.TAB_CUSTOMER.SHIPPING_ADDRESS_INFO.TITLE' |
                                                            translate}}
                                                        </div>
                                                        <div class='card-body'>
                                                            <div class="row">
                                                                <div class="col-lg-12">
                                                                    <div class='row'>
                                                                        <div class='col-md-12 form-group'>
                                                                            <label>
                                                                                {{'ORDERS.DETAIL.TAB_CUSTOMER.SHIPPING_ADDRESS_INFO.ADDRESS' | translate}}</label>
                                                                            <div class="disable-text">
                                                                                {{ order.shippingAddress1 != null && order.shippingAddress1 != '' ? order.shippingAddress1 : ' ' }}

                                                                                {{ order.shippingAddress2 != null && order.shippingAddress2 != '' ? ", " + order.shippingAddress2 : ' ' }}
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class='row'>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.SHIPPING_ADDRESS_INFO.CITY' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ order.shippingCity != null && order.shippingCity != '' ? order.shippingCity : ' ' }}
                                                                    </div>
                                                                </div>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.SHIPPING_ADDRESS_INFO.STATE' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ (shippingStates | displayValueFinder:
                                                                        {value:order.shippingStateID})?.length
                                                                        ?
                                                                        ( shippingStates | displayValueFinder:
                                                                        {value:order.shippingStateID})[0].label
                                                                        :' ' }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <div class='row'>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.SHIPPING_ADDRESS_INFO.ZIPCODE' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ order.shippingPostalCode != null && order.shippingPostalCode != '' ? order.shippingPostalCode : ' ' }}
                                                                    </div>
                                                                </div>
                                                                <div class='col-sm-6 form-group'>
                                                                    <label>
                                                                        {{'ORDERS.DETAIL.TAB_CUSTOMER.SHIPPING_ADDRESS_INFO.COUNTRY' | translate}}
                                                                    </label>
                                                                    <div class="disable-text">
                                                                        {{ (countries | displayValueFinder:
                                                                        {id:order.shippingCountryID})?.length
                                                                        ?
                                                                        ( countries | displayValueFinder:
                                                                        {id:order.shippingCountryID})[0].name
                                                                        :' ' }}
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </ng-container>
                            </div>
                            <!-- Customer End-->

                            <!-- Order Items Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navOrderItems" role="tabpanel" [ngClass]="selectedTab == 'navOrderItems' ? 'show active' : ''"
                                aria-labelledby="navOrderItems-tab" name="navOrderItems">
                              <div *ngIf="isEditOrder && !order.isPaused && !isCompleted && !isClosed"
                                class="mb-3 vertical-center justify-content-end dropdown-with-add"> 
                                <button  type="button" id="btn-add-order-item"
                                    class="btn btn-primary ml-3" (click)="openOrderItemModalPopup()">
                                    <i class="fa fa-plus-circle me-1" aria-hidden="true"></i>
                                       {{'ORDERS.DETAIL.TAB_ITEMS.BUTTON_ADD' | translate | configuredEntityName}}
                                </button>
                            </div>

                            <ng-container *ngIf="onceOrderItemTabClicked">
                                <app-dynamic-table *ngIf="!refreshOrderItems; else refreshChildComponent('OrderItem')"
                                    [code]="'ORDER_ITEM'" [parameters]="tbOrderItemTabParameters"  (onDeleteClick)="deleteOrderItem($event)">
                                </app-dynamic-table>
                            </ng-container>
                            </div>
                            <!-- Order Items End-->

                            <!-- Stage/Pause history Start-->
                            <div class="tab-pane fade" id="navHistory" role="tabpanel" [ngClass]="selectedTab == 'navHistory' ? 'show active' : ''"
                                aria-labelledby="navHistory-tab" name="navHistory">
                                <ng-container *ngIf="onceStageHistoryClicked">
                                    <ngx-history-tab [entityWorkflowId]="entityWorkflowId" [entityTypeId]="entityTypeId" [entityId]="orderId" [hoursInDay]="hoursInDay" [refreshStageHistory]="refreshStageHistory" [refreshActivityHistory]="refreshActivityHistory" [isListViewLayout]="isListViewLayout"></ngx-history-tab>
                                </ng-container>
                            </div>
                            <!-- Stage/Pause history end-->

                            <!-- Document Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navDocuments" role="tabpanel"
                                [ngClass]="selectedTab == 'navDocuments' ? 'show active' : ''" aria-labelledby="navDocuments-tab"
                                name="navDocuments">
                                <ng-container *ngIf="onceDocumentClicked">
                                    <ngx-entity-documents [entityID]="orderId" class="entity-documents" [entityTypeID]="entityTypeId"
                                        [isDocumentDownloadPermission]="isDocumentDownloadPermission && !order.isPaused && !isCompleted && !isClosed"
                                        [isEditPermission]="isEditOrder && !order.isPaused && !isCompleted && !isClosed"
                                        [refreshFromParent]="refreshActivityHistory"
                                        (refreshDocuments)="setRefreshDocument()">
                                    </ngx-entity-documents>
                                </ng-container>
                            </div>
                            <!-- Document End-->

                    </div>
                    </form>
                    <!-- Tab Content END -->
                    <div *ngIf="isAdditionalTab">
                        <!-- Tab Additional here -->
                        <ng-container>
                            <ngx-globle-nav-tab [isNativeTab]="isNativeTab" [isAdditionalTab]="isAdditionalTab" [navTabs]="navTabsMore" (setTab)="checkTabCall($event,0)"
                                class="col-12 p-0" (closeTab)="closeNavTab($event)"
                                [ngClass]="{'edit-icon-section': isReadOnly && !(['navWorkTasks', 'navContacts', 'navAttachment', 'navProducts', 'navHistory', 'additionalTabs','navDocuments'] | showHidePencilButton: activeTab)}"></ngx-globle-nav-tab>
                        </ng-container>
                    </div>
                    <!-- Tab Other Tabs Link -->
            </div>
        </div>
        <activity-section 
            class="col-xl-4 col-md-12 common-box pr-0"
            [entityTypeId]="entityTypeId" 
            [entityId]="orderId" 
            [isTagRequired]="true" 
            [isEditPermission]="isEditOrder"
            [isPaused]="order.isPaused"
            [isClosedStage]="isClosed"
            [isCompletedStage]="isCompleted"
            [isDocumentRequired]="true"
            [refreshDocument]="refreshDocument" 
            [refreshActivity]="refreshActivity" 
            [entityRecordTypeId]="entityRecordTypeID" 
            [isDocumentDownloadPermission]="isDocumentDownloadPermission && !order.isPaused && !isCompleted && !isClosed"
            (isTagListUpdated)="setRefreshEntityTag()" 
            (isActivityListUpdated)="setRefreshActivityHistory()" 
            [createdBy]="order?.createdBy"
            [privacyLevel]="null">
        </activity-section>
    </div>
</div>
<!-- Body End-->
</div>