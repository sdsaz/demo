<div class="flexlayout" *ngIf="!isViewProduct">
    <div class="form_wrapper">
        <div id="no-access-form">
            <div class="top">
                <img src="assets/images/default/NoAccessImage.png" alt="" class="mb-3">
                <div class="subtitle mt-0">{{'PRODUCTS.DETAIL.MESSAGE_PRODUCT_NOT_EXISTS' | translate |
                    configuredEntityName}}
                </div>
            </div>
        </div>
    </div>
</div>
<!-- If id is not exists then display message -->
<div class="flexlayout" *ngIf="!productForm && !isInitialLoading && hasPermission">
    <div class="form_wrapper">
        <div id="no-access-form">
            <div class="top">
                <img src="assets/images/default/NoAccessImage.png" alt="" class="mb-3">
                <div class="subtitle mt-0">{{'PRODUCTS.DETAIL.MESSAGE_PRODUCT_NOT_EXISTS' | translate |
                    configuredEntityName}}
                </div>
            </div>
        </div>
    </div>
</div>
<div class="page-containted" *ngIf="isLoaded && productForm && hasPermission">
    <!-- Header Start-->
    <div class="container-fluid">
        <div class="row">
            <div class="col-12 mb-10px">
                <div class="detail-header h-100">
                    <div class="page-content card border-0 mb-0 h-100">
                        <div class="card-body p-card">
                            <div class="row vertical-center h-100">
                                <div class="col-xl col-lg-4 col-md-12 mb-3 mb-lg-0 mb-sm-4 d-flex align-self-start">
                                    <div class="float-left text-center">
                                        <div *ngIf="!productPrimaryImageLoaded" id="entity-icon" class="entity-icon">
                                            <i class="fas fa-boxes" aria-hidden="true"></i>
                                        </div>
                                        <img *ngIf="productPrimaryImage" (load)="productPrimaryImageLoaded = true"
                                            class="entity-image" [src]="productPrimaryImage">
                                    </div>
                                    <div class="stage-details float-start">
                                        <p class="m-0">
                                            <span class="card-title mb-1">
                                                <label id="headingEntity">{{ 'PRODUCTS.DETAIL.TITLE' |
                                                    translate | configuredEntityName}}</label>
                                                <div class="overflow-box"><strong class="pre-text"
                                                        id="nameEntity">{{productName}}</strong></div>
                                                <div>
                                                    <span id="entityRating" class="mt-2 h-21 mr-2 vertical-center">
                                                        <entity-review-display [entityTypeId]="entityTypeId" [entityId]="productId" [isFromKanbanOrListView]="false"
                                                            [isEditPermission]="isEditProduct && !(product.isPaused ?? false)">
                                                        </entity-review-display>
                                                    </span>
                                                    <span class="mt-2 h-21 badge badge-primary badge--status mr-2"
                                                        id="badgeEntityRecordType">{{product.entityRecordTypeName}}</span>
                                                    <span id="badgeActiveInactive"
                                                        [ngClass]="product.isActive == true ? 'bg-primary' : 'bg-danger'"
                                                        class="mt-2 h-21 badge badge--status">
                                                        {{ product.isActive | active }}
                                                    </span>
                                                    <span id="badgePaused" *ngIf="product.isPaused"
                                                        class="mt-2 h-21 badge badge-danger badge--status ml-2">
                                                        {{ product.isPaused == true ? 'Paused' : '' }}
                                                    </span>
                                                </div>
                                            </span>
                                        </p>
                                    </div>
                                </div>
                                <div class="col-xl-8 col-lg details-section col-md-12 align-self-start">
                                    <div class="row">
                                        <div *ngIf="isHelpCode" class="col-header col-xl-2 col-lg-6 col-md-3 col-sm-4 mb-xl-0 mb-lg-3 mb-sm-3 mb-1">
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{'PRODUCTS.DETAIL.HELPCODE' | translate }}</label>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p class="m-0"><strong
                                                            id="shortcodeProduct">{{product.shortCode}}</strong></p>
                                                </div>
                                            </div>
                                        </div>

                                        <div *ngIf="isEntityWorkflow && isListViewLayout"
                                            class="col-header col-xxl col-xl-2 col-lg-6 col-md-3 col-sm-4 mb-xl-0 mb-lg-3 mb-sm-3 mb-1 header-value">
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{
                                                        'PRODUCTS.DETAIL.STATUS' | translate }}</label>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p class="m-0"><strong id="statusProduct">{{selectedStage?.name}}</strong></p>
                                                </div>
                                            </div>
                                        </div>

                                        <div *ngIf="hasRelatedAccount"
                                            class="col-xl col-lg-6 col-md-3 col-sm-4 mb-xl-0 mb-lg-3 mb-sm-3 mb-1 header-value col-header">
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{
                                                        'PRODUCTS.DETAIL.HEADER_RELATEDACCOUNT' | translate |
                                                        configuredEntityName }}</label>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <a [routerLink]="'/accounts/details/' + product.accountID"
                                                        [ngClass]="isViewAccount ? 'dark-blue font-weight-bold no-underline cursor-pointer pre-text' : 'no-link'">{{product.accountName}}</a>
                                                </div>
                                            </div>
                                        </div>
                                   
                                        <div class="col-header col-xl col-lg-6 col-md-3 col-sm-4 mb-xl-0 mb-lg-3 mb-sm-3 mb-1">
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label col-created-label">
                                                    <label>{{ 'PRODUCTS.DETAIL.HEADER_CREATED' | translate }}</label>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p class="m-0" id="lblCreatedDate">
                                                        {{product.created | date:'medium' }}
                                                    </p>
                                                </div>
                                            </div>
                                        </div>

                                        <div *ngIf="isEntityWorkflow" class="col-header col-xl col-lg-6 col-md-3 col-sm-4 mb-xl-0 mb-lg-3 mb-sm-3 mb-1">
                                            <div class="row mb-1 mb-sm-2">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'PRODUCTS.DETAIL.TOTAL_SPENT_TIME' | translate }}</label>
                                                    <i class="fas fa-info-circle dark-grey ml-1 info-tooltip" tooltipClass="custom-tooltip-class" [ngbTooltip]="('PRODUCTS.DETAIL.TOOLTIP_DURATION' | translate).replace('[[hoursInDay]]',hoursInDay)"
                                                        placement="top top-left" container="body" aria-hidden="true">
                                                    </i>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p-skeleton *ngIf="!totalSpentTime; else showTotalSpentTime" width="8rem" styleClass="mb-1"></p-skeleton>
                                                    <ng-template #showTotalSpentTime>
                                                        <p class="m-0" id="lblTotalSpentTime">
                                                            {{ totalSpentTime }}
                                                        </p>
                                                    </ng-template>
                                                </div>
                                            </div>
                                            <div class="row mb-1 mb-sm-2">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'PRODUCTS.DETAIL.TOTAL_EFFECTIVE_TIME' | translate }}</label>
                                                    <i class="fas fa-info-circle dark-grey ml-1 info-tooltip" tooltipClass="custom-tooltip-class" [ngbTooltip]="('PRODUCTS.DETAIL.TOOLTIP_DURATION' | translate).replace('[[hoursInDay]]',hoursInDay)"
                                                        placement="top top-left" container="body" aria-hidden="true">
                                                    </i>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p-skeleton *ngIf="!totalEffectiveTime; else showTotalEffectiveTime" width="8rem" styleClass="mb-1"></p-skeleton>
                                                    <ng-template #showTotalEffectiveTime>
                                                        <p class="m-0" id="lblTotalEffectiveTime">
                                                            {{ totalEffectiveTime }}
                                                        </p>
                                                    </ng-template>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-sm-12 col-header-label">
                                                    <label>{{ 'PRODUCTS.DETAIL.TOTAL_PAUSE_TIME' | translate }}</label>
                                                    <i class="fas fa-info-circle dark-grey ml-1 info-tooltip" tooltipClass="custom-tooltip-class" [ngbTooltip]="('PRODUCTS.DETAIL.TOOLTIP_DURATION' | translate).replace('[[hoursInDay]]',hoursInDay)"
                                                        placement="top top-left" container="body" aria-hidden="true">
                                                    </i>
                                                </div>
                                                <div class="col-sm-12 col">
                                                    <p-skeleton *ngIf="!totalPauseTime; else showTotalPauseTime" width="8rem" styleClass="mb-1"></p-skeleton>
                                                    <ng-template #showTotalPauseTime>
                                                        <p class="m-0" id="lblTotalPauseTime">
                                                            {{ totalPauseTime }}
                                                        </p>
                                                    </ng-template>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="back-arrow col-lg">
                                    <div class="row">
                                        <div class="col-12">
                                            <button id="btn-back" class='btn btn-secondary mb-12px' type='button'
                                                (click)="backToList()">
                                                {{ 'PRODUCTS.DETAIL.BUTTON_BACK' | translate }}
                                            </button>
                                        </div>
                                        <div *ngIf="isEditProduct && !product.isPaused" class="col-12">
                                            <div class="dropdown">
                                                <button class="btn btn-primary dropdown-toggle btn-action" type="button"
                                                    id="dropdownActionMenu" data-bs-toggle="dropdown"
                                                    aria-expanded="false">
                                                    {{ 'PRODUCTS.DETAIL.BUTTON_ACTION' | translate }}
                                                </button>
                                                <div class="dropdown-menu" aria-labelledby="dropdownActionMenu">
                                                    <a id="link-change-status" (click)="onActionChangeStatus()"
                                                        class="dropdown-item menu--item">
                                                        <i class="fas fa-toggle-on" aria-hidden="true"></i>
                                                        {{'PRODUCTS.DETAIL.ACTION_TITLE_CHANGESTATUS' | translate }}
                                                    </a>
                                                    <a *ngIf="isDeleteProduct" id="link-delete" (click)="onDeleteProductClick(product.id)" class="dropdown-item menu--item">
                                                        <i class="far fa-trash-alt me-1" aria-hidden="true"></i>
                                                        {{'PRODUCTS.DETAIL.ACTION_TITLE_DELETE' | translate }}
                                                    </a>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-xl-12 col-lg-12 align-self-end align-tags top-margin-tags">
                                    <div class="vertical-bottom flex-nowrap justify-content-between">
                                        <entity-tags-view [refreshEntityTag]="refreshEntityTag" [entityId]="productId"
                                            [entityTypeId]="entityTypeId" [entityRecordTypeId]="entityRecordTypeId">
                                        </entity-tags-view>
                                
                                        <div class="pt-3 pl-3 pe-2 d-flex bookmark-icon">
                                            <ngx-bookmark [entityTypeId]="entityTypeId" [entityId]="productId" [isEditPermission]="isEditProduct && !(product.isPaused ?? false)"
                                                class="font-18 me-3" [isFromKanbanOrListView]="false">
                                            </ngx-bookmark>
                                            <div *ngIf="product.isShowPauseOrResume">
                                                <i *ngIf="product.isPaused && (this._loggedInUser.userId == product.assignedTo || isResumeRecord)"
                                                    class="far fa-play-circle font-18 dark-grey cursor-pointer" tooltipClass="tooltip-backward-small"
                                                    [ngbTooltip]="'CRM.CONTACT.DETAIL.TOOLTIP_RESUME'| translate" id="resumeButton" container="body"
                                                    (click)="onProductStagePauseChanged(product, false)"></i>
                                                <i *ngIf="!isEditProduct && product.isPaused && (this._loggedInUser.userId != product.assignedTo && !isResumeRecord)"
                                                    class="far fa-play-circle font-18 dark-grey cursor-pointer" tooltipClass="tooltip-backward-small"
                                                    [ngbTooltip]="'CRM.CONTACT.DETAIL.MESSAGE_RESUME_NOT_ACCESS'| translate" id="resumeButtonNotAccess"
                                                    container="body"></i>
                                                <i *ngIf="isEditProduct && !product.isPaused && (this._loggedInUser.userId == product.assignedTo || isResumeRecord)"
                                                    class="far fa-pause-circle font-18 dark-grey cursor-pointer" tooltipClass="tooltip-backward-small"
                                                    [ngbTooltip]="'CRM.CONTACT.DETAIL.TOOLTIP_PAUSE'| translate" id="pauseButton" container="body"
                                                    (click)="onProductStagePauseChanged(product, true)"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Header End-->

    <!-- Stage Start-->
    <ng-container *ngIf="isEntityWorkflow && !isListViewLayout">
        <div class="page-content container-fluid stage-process">
            <!-- Stages Buttons List Start -->
            <div class="con_scroll d-none d-lg-block d-md-block d-sm-none d-xs-none">
                <div class="btn-group btn-group-toggle arrow-steps mb-10px" data-toggle="buttons" #menuContent>
                    <button type="button" class="btn btn-secondary btn--arrow" *ngFor="let stage of productStages"
                        id="btn-stage-change-{{(stage.name | lowercase)}}"
                        placement="top bottom" [ngbTooltip]="stage.name" container="body" triggers="hover" tooltipClass="tooltip-backward-small"
                        [disabled]="!isEditProduct || !product.isActive || product.isPaused"
                        class="{{ 'btn btn-secondary btn--arrow ' + (stage | stageCss: currentStage) }}"
                        (click)="onMarkStageAsComplete(stage.id)">
                        <input type="radio" [name]="stage.name" autocomplete="off">
                        <span class="btn_name">{{ stage.name }}</span>
                    </button>
                </div>
            </div>

            <div class="d-lg-none d-md-none d-sm-block d-xs-block py-2">
                <label>{{ 'PRODUCTS.DETAIL.STAGE_TITLE' | translate }}</label>
                <p-dropdown id="drp-StatusChange" *ngIf="selectedStage" class="form-control mb-2"
                    [options]="productStages" [disabled]="!isEditProduct || !product.isActive || product.isPaused"
                    [(ngModel)]="selectedStage" (onChange)="onMarkStageAsComplete($event.value.id)">
                    <ng-template let-stage pTemplate="selectedItem">
                        <div>{{stage.name}}</div>
                    </ng-template>
                    <ng-template let-stage pTemplate="item">
                        <div>{{stage.name}}</div>
                    </ng-template>
                </p-dropdown>
            </div>
            <!-- Stages Buttons List End -->
        </div>
    </ng-container>
    <!-- Stage End-->

    <!-- Body Start-->
    <div class="page-content container-fluid pr-0">
        <div class="row h---100vh w-100">
            <div class="col col-xl-8 col-lg-12 mb-xl-0 mb-2 pr-0 details-box">
                <!-- nav Tab Menu Start -->
                <div class="navTabs card-bottom-border border-0 p-card">
                    <div class="row width--100 border-bottom m-0 first-tabs">

                        <!-- Tab Section here -->
                        <ng-container>
                            <ngx-globle-nav-tab [navTabs]="navTabs" [isNativeTab]="isNativeTab"
                                (setTab)="checkTabCall($event,1)" class="col tabs-mobile p-0" (closeTab)="closeNavTab($event)"
                                [ngClass]="{'edit-icon-section': isReadOnly && !(tabsNameHideAction | showHidePencilButton: activeTab)}"></ngx-globle-nav-tab>
                        </ng-container>
                        <div class="col-auto edit-form-icon px-0">
                            <div *ngIf="isEditProduct && product.isActive && !product.isPaused">
                                <i class="fas fa-pencil-alt pencil-icon fa-lg clr-blue float-right cursor-pointer"
                                    aria-hidden="true" id="btnEditTabDetail" (click)="showHideDetailTab('EDIT')"
                                    *ngIf="isReadOnly && !(tabsNameHideAction | showHidePencilButton: activeTab)"></i>
                            </div>
                            <!-- Global save and cancel start -->
                            <div class="form-update-icons"
                                *ngIf="!isReadOnly && !(tabsNameHideAction | showHidePencilButton: activeTab)">
                                <i id="btn-cancel" *ngIf="isEditProduct && product.isActive && !product.isPaused"
                                    class="fas fa-times fa-lg dark-grey float-right mr-3"
                                    (click)="showHideDetailTab('CANCEL')" aria-hidden="true"></i>
                                <i *ngIf="isEditProduct && product.isActive && !product.isPaused" id="btn-save"
                                    class="fas fa-check fa-lg clr-blue float-right"
                                    (click)="showHideDetailTab('SAVE')" aria-hidden="true"></i>
                            </div>
                            <!-- Global save and cancel end -->
                        </div>
                    </div>

                    <!-- Tab Content Start -->
                    <form [hidden]="isAdditionalTab" [formGroup]="productForm">
                        <div class="tab-content border-0 mt-0" id="productDetailTabContent">
                            <!-- Details Start-->
                            <div class="tab-pane fade px-0 p-0" id="navDetails" role="tabpanel"
                                [ngClass]="selectedTab == 'navDetails' ? 'show active' : ''"
                                aria-labelledby="navDetails-tab" name="navDetails">
                                <!-- Basic Information Start-->
                                <div class="card border-0 m-0 pt-md-0 pt-3">
                                    <div class="card-header btn-card-edit py-0">
                                        <span class="vertical-center py-md-3 pt-0 pb-3 line-height-1">{{
                                            'PRODUCTS.DETAIL.TAB_DETAILS.BASIC_INFO' | translate }}</span>
                                    </div>
                                    <div class="card-body">
                                        <div class="row">
                                            <div class='col-xl-4 col-md-6 col-sm-6 form-group'>
                                                <label>
                                                    {{ 'PRODUCTS.DETAIL.TAB_DETAILS.NAME' | translate }}
                                                    <span class="mandatory"></span>
                                                </label>
                                                <div *ngIf="isReadOnly" class="disable-text pre-text">{{ product.name ?
                                                    product.name : '&nbsp;' }}</div>
                                                <input #productTxtName *ngIf="!isReadOnly" id="txt-name" type="text"
                                                    class="form-control" formControlName="name"
                                                    [(ngModel)]="product.name"
                                                    [ngClass]="{ 'is-invalid': productfrm.name.errors && (productfrm.name.dirty || productfrm.name.touched) }"
                                                    trimValue>
                                                <div *ngFor='let validation of productValidationMessages.name'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='productfrm.name.hasError(validation.type) && productfrm.name.errors && (productfrm.name.dirty || productfrm.name.touched)'
                                                        id="errorNameIsRequired">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-xl-4 col-md-6 col-sm-6 form-group">
                                                <label>{{'PRODUCTS.DETAIL.TAB_DETAILS.CODE' | translate}}
                                                </label>
                                                <div *ngIf="isReadOnly" class="disable-text">
                                                    {{ product.code ? product.code : '&nbsp;' }}
                                                </div>

                                                <input *ngIf="!isReadOnly" type="text" formControlName="code"
                                                    id="txt-code" class="form-control ht--40" name="code"
                                                    [(ngModel)]="product.code"
                                                    [ngClass]="{ 'is-invalid': productfrm.code.errors && (productfrm.code.dirty || productfrm.code.touched)}">
                                                <div *ngFor='let validation of productValidationMessages.code'
                                                    class='invalid-feedback'>
                                                    <div id="errorCodeMustBeValid"
                                                        *ngIf="productfrm.code.hasError(validation.type) && productfrm.code.errors && (productfrm.code.dirty || productfrm.code.touched)">
                                                        {{ validation.message | translate}}
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-4 col-sm-6 form-group">
                                                <label>{{'PRODUCTS.ADD_DIALOG.STOCK_QUANTITY' | translate}} </label>
                                                <div class="inner-addon">
                                                    <div *ngIf="isReadOnly" class="disable-text">
                                                        {{product.stockQty | number:'1.3-3'}}
                                                    </div>
                                                </div>
                                                <div class="inner-addon" *ngIf="!isReadOnly">
                                                    <input id="txt-stockQty" type="text" class="form-control ht--40" name="stockQty" formControlName="stockQty"
                                                        [(ngModel)]="product.stockQty" trimValue mask="separator.3" thousandSeparator="," maxlength="18"
                                                        [ngClass]="{ 'is-invalid': productfrm.stockQty.errors && (productfrm.stockQty.dirty || productfrm.stockQty.touched)}">
                                                    <div *ngFor='let validation of productValidationMessages.stockQty' class='invalid-feedback'>
                                                        <div *ngIf='productfrm.stockQty.hasError(validation.type) && productfrm.stockQty.errors && (productfrm.stockQty.dirty || productfrm.stockQty.touched)'>
                                                            {{ validation.message | translate }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-xl-4 col-sm-6 form-group">
                                                <label>{{'PRODUCTS.ADD_DIALOG.UOM' | translate}}</label>
                                                <i class="fas fa-info-circle dark-grey ml-1 info-tooltip" ngbTooltip="Unit Of Measurement" placement="top top-left" container="body" aria-hidden="true"></i>
                                                <div class="inner-addon">
                                                    <div *ngIf="isReadOnly" class="disable-text">
                                                        {{product.uomName}}
                                                    </div>
                                                </div>
                                                <div *ngIf="!isReadOnly">
                                                    <ngx-control-level-loading-bar *ngIf="showUOMLoader"></ngx-control-level-loading-bar>
                                                    <p-dropdown id="drp-uom" name="uomid" formControlName="uomid"
                                                        [options]="groupedUOMTypes" optionLabel="label"  filterBy="label,groupLabel"
                                                        optionValue="value" [group]="true" class="form-control"
                                                        placeholder="{{'PRODUCTS.ADD_DIALOG.UOM_PLACEHOLDER' | translate}}"
                                                        [filter]="true" [resetFilterOnHide]="false" [showClear]="true"
                                                        (onChange)="onUOMSelectionChange($event.value)"
                                                        [(ngModel)]="product.uomid">
                                                        <ng-template let-group pTemplate="group">
                                                            {{group.label}}
                                                        </ng-template>
                                                        <ng-template let-item pTemplate="item">
                                                            <span>{{item.label}}</span>
                                                        </ng-template>
                                                    </p-dropdown>
                                                </div>
                                            </div>
                                            <div class='col-xl-4 col-sm-6 form-group'>
                                                <label>{{'PRODUCTS.ADD_DIALOG.PRICE' | translate}} <span
                                                        class="mandatory"></span></label>
                                                <div class="inner-addon left-addon">
                                                    <div *ngIf="isReadOnly" class="disable-text">
                                                        <div *ngIf="(product.price != null ) else blankprice">
                                                            {{(currencySymbol)+(product.price | number:'1.2-2') }}
                                                        </div>
                                                        <ng-template #blankprice>
                                                            <div>&nbsp;</div>
                                                        </ng-template>
                                                    </div>
                                                </div>
                                                <div class="inner-addon left-addon" *ngIf="!isReadOnly">
                                                    <span>{{currencySymbol}}</span>
                                                    <input id="txt-price" type="text" class="form-control ht--40"
                                                        name="price" formControlName="price" [(ngModel)]="product.price" maxlength="18"
                                                        mask="separator.2" thousandSeparator=","
                                                        [ngClass]="{ 'is-invalid': productfrm.price.errors && (productfrm.price.dirty || productfrm.price.touched)}">
                                                    <div *ngFor='let validation of productValidationMessages.price'
                                                        class='invalid-feedback'>
                                                        <div *ngIf='productfrm.price.hasError(validation.type) && productfrm.price.errors && (productfrm.price.dirty || productfrm.price.touched)'
                                                            id="errorPriceMustBeValidNumber">
                                                            {{ validation.message | translate }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>

                                            <ng-container *ngIf="isEntityWorkflow">
                                                <div class='col-xl-4 col-sm-6 form-group'>
                                                    <label>{{ 'PRODUCTS.DETAIL.TAB_DETAILS.ASSIGNED_TO' | translate
                                                        }}</label>
                                                        <ng-container *ngIf="isReadOnly; else templateDrpAssignedTo">
                                                            <div *ngIf="isReadOnly" class="disable-text">
                                                                {{
                                                                product.assignedToName != null &&
                                                                product.assignedToName != '' ?
                                                                product.assignedToName : ''
                                                                }}
                                                            </div>
                                                        </ng-container>
                                                        <ng-template #templateDrpAssignedTo>
                                                            <!-- Assigned To Loading Bar -->
                                                            <ngx-control-level-loading-bar *ngIf="showAssignedToLoader"></ngx-control-level-loading-bar>
                                                        
                                                            <p-dropdown *ngIf="!isReadOnly" id="drp-assignedToIDs"
                                                                [placeholder]="('PRODUCTS.DETAIL.TAB_DETAILS.FILTER_PLACEHOLDER_ASSIGNED_TO' | translate)" class="form-control"
                                                                [options]="assignedToUsers" formControlName="assignedTo" [(ngModel)]="product.assignedTo" [filter]="true"
                                                                (onFilter)="assignedToOnFilter($event)" (onChange)="assignedToOnChange($event)" [resetFilterOnHide]="false">
                                                            </p-dropdown>
                                                        </ng-template>
                                                </div>

                                                <div *ngIf="isEntityWorkflow && !isListViewLayout" class='col-xl-4 col-sm-6 form-group'>
                                                    <!-- stage task start -->
                                                    <label>{{ 'PRODUCTS.DETAIL.TAB_DETAILS.TASKS' | translate }}</label>
                                                    <div *ngIf="isReadOnly && currentStageTask != null"
                                                        class="disable-text">
                                                        {{
                                                        currentStageTask && currentStageTask.length > 0
                                                        ? (product.selectedStageTaskIds?.length ?? 0) + ' of ' +
                                                        currentStageTask.length + ' completed' : ''
                                                        }}

                                                    </div>
                                                    <div *ngIf="isReadOnly && (currentStageTask == undefined || currentStageTask == null)"
                                                        class="disable-text">
                                                        {{ 'PRODUCTS.DETAIL.TAB_DETAILS.NO_TASKS' | translate }}
                                                    </div>

                                                    <div *ngIf="!isReadOnly && currentStageTask != null"
                                                        class="input-group entity-dropdown custom-dropdown-muliselect">
                                                        <p-multiSelect [options]="currentStageTask" id="drp-stage-task"
                                                            class="entity-multiSelect" optionLabel="name"
                                                            formControlName="selectedStageTaskIds"
                                                            [(ngModel)]="product.selectedStageTaskIds"
                                                            [maxSelectedLabels]="500" [showToggleAll]="false"
                                                            [filter]="false" [showHeader]="false"
                                                            [displaySelectedLabel]='false'
                                                            [defaultLabel]="currentStageTask && currentStageTask.length > 0 ? (product.selectedStageTaskIds?.length ?? 0) + ' of ' + currentStageTask.length + ' completed' : ''">
                                                        </p-multiSelect>
                                                    </div>
                                                    <div class="min-height-38px disable-text"
                                                        *ngIf="!isReadOnly && (currentStageTask == null || currentStageTask == '')">
                                                        {{ 'PRODUCTS.DETAIL.TAB_DETAILS.NO_TASKS' | translate }}
                                                    </div>
                                                    <!-- stage task end -->
                                                </div>
                                                <div class='col-xl-4 col-sm-6 form-group' *ngIf="isEntityWorkflow && isListViewLayout">
                                                    <label>{{'PRODUCTS.DETAIL.TAB_DETAILS.STATUS' | translate}} <span class="mandatory"></span></label>
                                                    <div class="disable-text" *ngIf="isReadOnly">
                                                        {{ (productStages | displayValueFinder: {id:product.entityStageId})?.length
                                                        ?
                                                        (productStages | displayValueFinder: {id:product.entityStageId})[0].name : ' ' }}
                                                    </div>
                                                    <p-dropdown *ngIf="!isReadOnly" id="drp-stageId" class="form-control" formControlName="entityStageId"
                                                        [filter]="true" [resetFilterOnHide]="false" [options]="productStages"
                                                        placeholder="{{'PRODUCTS.DETAIL.TAB_DETAILS.STATUS_PLACEHOLDER' | translate}}" optionLabel="name"
                                                        optionValue="id" [(ngModel)]="product.entityStageId"
                                                        [ngClass]="{ 'is-invalid': submitted && productfrm.entityStageId.errors }">
                                                    </p-dropdown>
                                                    <div *ngFor='let validation of productValidationMessages.entityStageId' class='invalid-feedback'>
                                                        <div *ngIf='productfrm.entityStageId.hasError(validation.type) && submitted && productfrm.entityStageId.errors'
                                                            id="errorStageIsRequired">
                                                            {{ validation.message | translate }}
                                                        </div>
                                                    </div>
                                                </div>
                                            </ng-container>

                                            <div class="col-md-12 form-group">
                                                <label>{{'PRODUCTS.ADD_DIALOG.DESCRIPTION' | translate}}</label>

                                                <div class="inner-addon left-addon">
                                                    <div *ngIf="isReadOnly" class="disable-text">
                                                        {{ product.description ? product.description : '&nbsp;' }}
                                                    </div>
                                                </div>

                                                <textarea *ngIf="!isReadOnly" formControlName="description"
                                                    id="txt-description" class="form-control ht--40" name="description"
                                                    rows="6" [(ngModel)]="product.description"
                                                    [ngClass]="{ 'is-invalid': productfrm.description.errors && (productfrm.description.dirty || productfrm.description.touched)}">
                                                                                        </textarea>
                                                <div *ngFor='let validation of productValidationMessages.description'
                                                    class='invalid-feedback'>
                                                    <div *ngIf='productfrm.description.hasError(validation.type) && productfrm.description.errors && (productfrm.description.dirty || productfrm.description.touched)'
                                                        id="errorDescriptionMustBeValidNumber">
                                                        {{ validation.message | translate }}
                                                    </div>
                                                </div>
                                            </div>

                                            <div class="col-md-6">
                                                <div class="row">
                                                    <div class='col-md-12 col-sm-12 form-group'>
                                                        <div class="row">
                                                            <!-- start Product Address -->
                                                            <div class="col-lg-12 pr-xl-3 pr-lg-0">
                                                                <div class="card border-0 m-0 px-0">
                                                                    <div class="card-header btn-card-edit  pt-0">
                                                                        {{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.TITLE'
                                                                        | translate | configuredEntityName}}
                                                                    </div>
                                                                    <div class='card-body'>
                                                                        <div class="row">
                                                                            <div class="col-lg-12">
                                                                                <div class='row'>
                                                                                    <div class='col-md-12 form-group'>
                                                                                        <label>
                                                                                            {{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.ADDRESS'
                                                                                            | translate}}</label>
                                                                                        <div class="disable-text"
                                                                                            *ngIf="isReadOnly">
                                                                                            {{isGetMultiLineAddressLine()}}
                                                                                        </div>
                                                                                        <input *ngIf="!isReadOnly"
                                                                                            type="text"
                                                                                            id="txt-address1"
                                                                                            class="form-control"
                                                                                            formControlName="address1"
                                                                                            [(ngModel)]="product.address1"
                                                                                            autocomplete="off"
                                                                                            maxlength="200" trimValue
                                                                                            [ngClass]="{ 'is-invalid': productfrm.address1.errors && (productfrm.address1.dirty || productfrm.address1.touched)}"
                                                                                            (input)="onAddressChangeValidation(productForm)">
                                                                                        <div *ngFor='let validation of productValidationMessages.address1'
                                                                                            class='invalid-feedback'>
                                                                                            <div *ngIf='productfrm.address1.hasError(validation.type) && productfrm.address1.errors && (productfrm.address1.dirty || productfrm.address1.touched)'
                                                                                                id="errorAddressIsRequired">
                                                                                                {{ validation.message |
                                                                                                translate }}
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                </div>
                                                                                <div class='row'>
                                                                                    <div class='col-md-12'>
                                                                                        <input *ngIf="!isReadOnly"
                                                                                            type="text"
                                                                                            id="txt-address2"
                                                                                            class="form-control mb-3"
                                                                                            formControlName="address2"
                                                                                            [(ngModel)]="product.address2"
                                                                                            autocomplete="off"
                                                                                            maxlength="200" trimValue>
                                                                                    </div>
                                                                                </div>
                                                                                <div class='row'>
                                                                                    <div class='col-sm-6 form-group'>
                                                                                        <label>
                                                                                            {{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.CITY'
                                                                                            | translate}}
                                                                                        </label>
                                                                                        <div class="disable-text"
                                                                                            *ngIf="isReadOnly">
                                                                                            {{ product.city != null &&
                                                                                            product.city != '' ?
                                                                                            product.city : ' ' }}
                                                                                        </div>
                                                                                        <input *ngIf="!isReadOnly"
                                                                                            type="text" id="txt-city"
                                                                                            class="form-control"
                                                                                            formControlName="city"
                                                                                            [(ngModel)]="product.city"
                                                                                            autocomplete="off"
                                                                                            maxlength="100" trimValue
                                                                                            (input)="onAddressChangeValidation(productForm)">
                                                                                    </div>
                                                                                    <div class='col-sm-6 form-group'>
                                                                                        <label>
                                                                                            {{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.STATE'
                                                                                            | translate}}
                                                                                        </label>
                                                                                        <div class="disable-text"
                                                                                            *ngIf="isReadOnly">
                                                                                            {{ (states |
                                                                                            displayValueFinder:
                                                                                            {value:product.stateID})?.length
                                                                                            ?
                                                                                            ( states |
                                                                                            displayValueFinder:
                                                                                            {value:product.stateID})[0].label
                                                                                            :' ' }}
                                                                                        </div>

                                                                                        <!-- State Loading Bar -->
                                                                                        <ngx-control-level-loading-bar
                                                                                            *ngIf="!isReadOnly && showStateLoader"></ngx-control-level-loading-bar>

                                                                                        <p-dropdown *ngIf="!isReadOnly"
                                                                                            [(ngModel)]="product.stateID"
                                                                                            class="form-control"
                                                                                            id="drp-state"
                                                                                            formControlName="stateId"
                                                                                            [filter]="true"
                                                                                            [resetFilterOnHide]="false"
                                                                                            [showClear]="true"
                                                                                            [options]="states"
                                                                                            placeholder="{{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.STATE_PLACEHOLDER' | translate}}"
                                                                                            optionLabel="label"
                                                                                            optionValue="value"
                                                                                            (onChange)="onAddressChangeValidation(productForm)">
                                                                                        </p-dropdown>
                                                                                    </div>
                                                                                </div>
                                                                                <div class='row'>
                                                                                    <div class='col-sm-6 form-group'>
                                                                                        <label>
                                                                                            {{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.ZIPCODE'
                                                                                            | translate}}
                                                                                        </label>
                                                                                        <div class="disable-text"
                                                                                            *ngIf="isReadOnly">
                                                                                            {{ product.postalCode !=
                                                                                            null && product.postalCode
                                                                                            != '' ? product.postalCode :
                                                                                            ' ' }}
                                                                                        </div>
                                                                                        <input *ngIf="!isReadOnly"
                                                                                            type="text"
                                                                                            id="txt-postal-code"
                                                                                            class="form-control"
                                                                                            formControlName="postalCode"
                                                                                            [mask]="_commonHelper.globalInputPostalCodeFormate"
                                                                                            [dropSpecialCharacters]="false"
                                                                                            [(ngModel)]="product.postalCode"
                                                                                            autocomplete="off"
                                                                                            maxlength="10"
                                                                                            [ngClass]="{ 'is-invalid': submitted && productfrm.postalCode.errors }"
                                                                                            (input)="onAddressChangeValidation(productForm)">
                                                                                        <div *ngFor='let validation of productValidationMessages.postalCode'
                                                                                            class='invalid-feedback'>
                                                                                            <div id="errorPostalCodeMustBeValid"
                                                                                                *ngIf="productfrm.postalCode.hasError(validation.type) && submitted && productfrm.postalCode.errors  ">
                                                                                                {{ validation.message |
                                                                                                translate}}
                                                                                            </div>
                                                                                        </div>
                                                                                    </div>
                                                                                    <div class='col-sm-6 form-group'>
                                                                                        <label>
                                                                                            {{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.COUNTRY'
                                                                                            | translate}}
                                                                                        </label>
                                                                                        <div class="disable-text"
                                                                                            *ngIf="isReadOnly">
                                                                                            {{ (countries |
                                                                                            displayValueFinder:
                                                                                            {id:product.countryID})?.length
                                                                                            ?
                                                                                            ( countries |
                                                                                            displayValueFinder:
                                                                                            {id:product.countryID})[0].name
                                                                                            :' ' }}
                                                                                        </div>
                                                                                        <p-dropdown *ngIf="!isReadOnly"
                                                                                            [(ngModel)]="product.countryID"
                                                                                            class="form-control"
                                                                                            id="drp-country"
                                                                                            formControlName="countryId"
                                                                                            [filter]="true"
                                                                                            [resetFilterOnHide]="false"
                                                                                            [showClear]="false"
                                                                                            [options]="countries"
                                                                                            placeholder="{{'PRODUCTS.DETAIL.TAB_DETAILS.PRODUCT_ADDRESS_INFO.COUNTRY_PLACEHOLDER' | translate}}"
                                                                                            optionLabel="name"
                                                                                            optionValue="id"
                                                                                            (onChange)="onCountrySelectionChange($event.value, productForm)">
                                                                                        </p-dropdown>
                                                                                    </div>
                                                                                </div>
                                                                            </div>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <!-- end BillingAddress -->
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="col-md-12">

                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <!-- Details End-->

                            <!-- Custom Start-->
                            <div class="tab-pane fade px-0 pt-0"
                                [ngClass]="selectedTab == ('nav' + tab.tabName | removeWhiteSpace) ? 'show active' : ''"
                                *ngFor="let tab of formDataJSON; let i = index"
                                id="{{ 'nav' + tab.tabName | removeWhiteSpace }}" name="navCustom" role="tabpanel"
                                aria-labelledby="navCustom-tab">
                                <!-- Section Start-->
                                <div class='card border-0 m-0 pt-md-0 pt-3'
                                    *ngFor="let section of tab.sections; let j = index">
                                    <div class="card-header btn-card-edit py-0">
                                        <span *ngIf="section.sectionName"
                                            class="vertical-center py-md-3 pt-0 pb-3 line-height-1">
                                            {{ section.sectionName }}
                                        </span>
                                    </div>
                                    <div class='card-body'>
                                        <div class='row'>
                                            <ngx-custom-field [formGroup]="productForm" [section]="section"
                                                [controls]="section.controls"
                                                [customFieldJSONData]="product.customFieldJSONData"
                                                [isReadOnly]="isReadOnly" [submitted]="submitted"
                                                [currencySymbol]="currencySymbol"
                                                [refreshTabularDataSource]="refreshCustomFieldDatasource"
                                                [entityID]="productId" [entityTypeID]="entityTypeId"
                                                [entityRecordTypeID]="entityRecordTypeId"></ngx-custom-field>
                                        </div>
                                    </div>
                                </div>
                                <!-- Section End-->
                            </div>
                            <!-- Custom End-->


                            <!-- Related  Product Sku list Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navSkus" role="tabpanel"
                                [ngClass]="selectedTab == 'navSkus' ? 'show active' : ''" aria-labelledby="navSkus-tab"
                                name="navSKU">
                                <div *ngIf="isAddProductSku && product.isActive"
                                    class="mb-3 vertical-center justify-content-end dropdown-with-add">
                                    <button *ngIf="isAddProductSku && product.isActive && !product.isPaused" type="button"
                                        id="btn-add-relatedContact" class="btn btn-primary ml-3"
                                        (click)="addProductSku()">
                                        <i class="fa fa-plus-circle me-1" aria-hidden="true"></i>
                                        {{'PRODUCTS.DETAIL.TAB_PRODUCTSKU.BUTTON_ADD' | translate|
                                        configuredEntityName}}
                                    </button>
                                </div>
                                <div class="table-responsive">
                                    <ng-container *ngIf="onceProductClicked">
                                        <app-dynamic-table [code]="'PRODUCT_RELATED_SKUS'"
                                            *ngIf="!refreshProductSkus; else refreshChildComponent('ProductSkus');"
                                            [parameters]="tbProductSkuParameters"
                                            (onDeleteClick)="onDeleteProductSku($event)"
                                            (onEditClick)="onEditProductSku($event)"
                                            (button4)="onStatusChange($event)">
                                        </app-dynamic-table>
                                    </ng-container>
                                </div>
                            </div>
                            <!-- Related Product Sku list End-->

                            <!--  Product Category list Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navCategories" role="tabpanel"
                                [ngClass]="selectedTab == 'navCategories' ? 'show active' : ''"
                                aria-labelledby="navCategories-tab" name="navProductCategories">
                                <div *ngIf="isEditProduct && product.isActive && !product.isPaused"
                                    class="mb-3 vertical-center justify-content-end dropdown-with-add">
                                    <p-dropdown #relatedCategoryDrp *ngIf="categoriesForProductCategories"
                                        id="drp-productCategory" [options]="categoriesForProductCategories"
                                        [filter]="true" [resetFilterOnHide]="false" [showClear]="true"
                                        [(ngModel)]="selectedCategory" [ngModelOptions]="{standalone: true}"
                                        class="form-control static-dropdown-width text-left mb-0"
                                        placeholder="{{'PRODUCTS.DETAIL.TAB_PRODUCTCATEGORY.ADD_PRODUCTCATEGORY_PLACEHOLDER' | translate| configuredEntityName}}"
                                        (onFilter)="relatedCategoriesOnFilter($event)"
                                        (onChange)="relatedCategoriesOnChange($event)" optionLabel="name"
                                        optionValue="id">
                                        <ng-template let-entity pTemplate="item">
                                            <div class="entity-pad pl-0">
                                                {{entity.code ? (entity.name + ' ('+ entity.code+')') : entity.name}}
                                            </div>
                                        </ng-template>
                                    </p-dropdown>
                                    <button *ngIf="isAddProduct" type="button" id="btn-add-productCategory"
                                        class="btn btn-primary ml-3" (click)="addProductCategory()">
                                        <i class="fa fa-plus-circle" aria-hidden="true"></i>
                                    </button>
                                </div>
                                <div class="table-responsive">
                                    <ng-container *ngIf="onceProductCategoryClicked">
                                        <app-dynamic-table
                                            *ngIf="!refreshProductCategories; else refreshChildComponent('ProductCategories')"
                                            [code]="'PRODUCT_CATEGORY'" [parameters]="tbProductCategoryParameters"
                                            (onDeleteClick)="deleteProductCategoryProduct($event)">
                                        </app-dynamic-table>
                                    </ng-container>
                                </div>
                            </div>
                            <!--  list End-->


                            <!-- Visuals Tabs -->
                            <div class="tab-pane fade p-3" id="navVisuals" role="tabpanel"
                                [ngClass]="selectedTab == 'navVisuals' ? 'show active' : ''"
                                aria-labelledby="navVisuals-tab" name="navVisuals">
                                <ngx-tab-level-loader
                                    *ngIf="!productImages; else showProductImagesCarousel"></ngx-tab-level-loader>

                                <ng-template #showProductImagesCarousel>
                                    <div *ngIf="productImages?.length > 0" id="carouselExampleControls"
                                        class="carousel slide visuals-carousel mb-4" data-bs-ride="carousel">
                                        <div class="carousel-inner">
                                            <div *ngFor="let productImage of productImages; let i = index"
                                                class="carousel-item" [ngClass]="{ 'active': 0 === i }">
                                                <img class="d-block" [src]="productImage.signedFileUrl"
                                                    [alt]="productImage.name" (load)="productImage.loaded = true">

                                                <div *ngIf="productImage.id != product.primaryImageID && isEditProduct && product.isActive"
                                                    class="text-center mt-2">
                                                    <button type="button" class="btn btn-outline-secondary btn-sm mr-2"
                                                        (click)="removeImage(productImage.id)">
                                                        {{'PRODUCTS.DETAIL.TAB_VISUALS.REMOVE_IMAGE' | translate |
                                                        configuredEntityName}}
                                                    </button>
                                                    <button type="button" class="btn btn-primary btn-sm"
                                                        (click)="setImageAsPrimary(productImage.id, productImage.signedFileUrl)">
                                                        {{'PRODUCTS.DETAIL.TAB_VISUALS.SET_AS_PRIMARY' | translate |
                                                        configuredEntityName}}
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                        <a class="carousel-control-prev" data-bs-target="#carouselExampleControls"
                                            role="button" data-bs-slide="prev" (click)="setImageCount('prev')">
                                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                                            <span class="sr-only">Previous</span>
                                        </a>
                                        <a class="carousel-control-next" data-bs-target="#carouselExampleControls"
                                            role="button" data-bs-slide="next" (click)="setImageCount('next')">
                                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                                            <span class="sr-only">Next</span>
                                        </a>
                                    </div>
                                </ng-template>
                                <div *ngIf="totalImages && totalImages>0" class="text-center mb-3">{{currentImage}} of {{totalImages}}</div>
                                <div *ngIf="isEditProduct && allowToUploadImage && product.isActive"
                                    class="visuals-upload">
                                    <div class="font-semibold mb-2 w-100">{{'PRODUCTS.DETAIL.TAB_VISUALS.UPLOAD_IMAGE' |
                                        translate | configuredEntityName }}</div>
                                    <div class="dropzone-wrapper dropzone-visuals mb-2" ng2FileDrop
                                        [uploader]="uploader" [ngClass]="{'dragover': hasDropZoneOver}"
                                        (fileOver)="fileOverBase($event)" (onFileDrop)="fileDroppedArea($event)">
                                        <div class="progress file-upload-process">
                                            <div class="progress-bar" role="progressbar"
                                                [ngStyle]="{ 'width': uploader.progress + '%' }"></div>
                                        </div>
                                        <div class="dropzone-desc">
                                            <i aria-hidden="true" class="fas fa-upload"></i>
                                            <p>{{this.imageUploadMsg}}</p>
                                        </div>
                                        <input #fileuploadcontrol type="file" class="dropzone" multiple="" ng2FileSelect id="uploadVisuals"
                                            [uploader]="uploader" (change)="fileDropped($event)" (click)="onSelectFileClick()">
                                    </div>
                                </div>
                            </div>
                            <!--  Visuals Tab End-->

                            <!-- Work Tasks Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navWorkTasks" role="tabpanel"
                                [ngClass]="selectedTab == 'navWorkTasks' ? 'show active' : ''" aria-labelledby="navWorkTasks-tab"
                                name="navWorkTasks">
                                <div class="mb-3 vertical-center justify-content-end dropdown-with-add" *ngIf="isEditProduct && isAddWorkTask && product.isActive && !product.isPaused">
                                    <button *ngIf="onceWorkTaskClicked" type="button" id="btn-add-workTask" class="btn btn-primary ml-3"
                                        (click)="addWorkTask()">
                                        <i *ngIf="workTaskSubTypeDetails?.iconClass" class="{{workTaskSubTypeDetails?.iconClass}} mr-1"
                                            aria-hidden="true"></i>
                                        {{('PRODUCTS.DETAIL.TAB_WORKTASKS.ADD_WORKTASK_PREFIX'| translate) + " " +
                                        workTaskSubTypeDetails?.name}}
                                    </button>
                                </div>
                                <div class="expandable-card">
                                    <ng-container *ngIf="onceWorkTaskClicked">
                                        <ngx-work-task-expandable-table [entityID]="productId" [entityTypeID]="entityTypeId" [refresh]="refreshWorkTaskTab"
                                            [isEntityActive]="product.isActive"></ngx-work-task-expandable-table>
                                    </ng-container>
                                </div>
                            </div>
                            <!-- Work Tasks End-->

                            <!-- Related cases Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navRelatedCases" role="tabpanel" [ngClass]="selectedTab == 'navRelatedCases' ? 'show active' : ''"
                                aria-labelledby="navRelatedCases-tab" name="navRelatedCases">
                                <div *ngIf="isEditProduct && isAddCase && product.isActive && !product?.isPaused"
                                    class="mb-3 vertical-center justify-content-end dropdown-with-add">
                                    <ngx-control-level-loading-bar *ngIf="isShowLoaderForCase"></ngx-control-level-loading-bar>
                                    <div>
                                        <button *ngIf="onceRelatedCasesClicked" type="button" id="btn-add-case"
                                            class="btn btn-primary ml-3" (click)="addCase()">
                                            <i class="fa-solid fa-file-invoice me-1" aria-hidden="true"></i>
                                            {{ 'CASES.ADD_DIALOG.TITLE' | translate | configuredEntityName }}
                                        </button>
                                    </div>
                                </div>
                                <div class="table-responsive">
                                    <ng-container *ngIf="onceRelatedCasesClicked">
                                        <app-dynamic-table 
                                            *ngIf="!refreshCaseTab; else refreshChildComponent('RelatedCases')"
                                            [code]="'ENTITY_CASES'" 
                                            [parameters]="tbRelatedCasesParameters"
                                            (onEditClick)="editCase($event)"
                                            (onDeleteClick)="deleteCase($event)"
                                            [entityHiddenFieldSettings]="entityHiddenFieldSettings"
                                            [parentEntityTypeId]="entityTypeId"
                                            [sectionCodes]="sectionCodeName.EntityCaseColumn">
                                        </app-dynamic-table>
                                    </ng-container>
                                </div>
                            </div>
                            <!-- Related cases End-->

                            <!-- Stage/Pause history Start-->
                            <div class="tab-pane fade" id="navHistory" role="tabpanel" [ngClass]="selectedTab == 'navHistory' ? 'show active' : ''" aria-labelledby="navHistory-tab" name="navHistory">
                                <ng-container *ngIf="onceStageHistoryClicked">
                                    <ngx-history-tab [entityWorkflowId]="entityWorkflowId" [entityTypeId]="entityTypeId" [entityId]="productId" [hoursInDay]="hoursInDay" [refreshStageHistory]="refreshStageHistory" [refreshActivityHistory]="refreshActivityHistory" [isListViewLayout]="isListViewLayout"></ngx-history-tab>
                                </ng-container>
                            </div>
                            <!-- Stage/Pause history End-->

                            <!-- Document Start-->
                            <div class="tab-pane fade p-3 search-wrapper" id="navDocuments" role="tabpanel"
                                [ngClass]="selectedTab == 'navDocuments' ? 'show active' : ''" aria-labelledby="navDocuments-tab"
                                name="navDocuments">
                                <ng-container *ngIf="onceDocumentClicked">
                                    <ngx-entity-documents [entityID]="productId" class="entity-documents" [entityTypeID]="entityTypeId"
                                        [isDocumentDownloadPermission]="isDocumentDownloadPermission && product.isActive"
                                        [isEditPermission]="isEditProduct && product.isActive"
                                        [refreshFromParent]="refreshActivityHistory"
                                        (refreshDocuments)="setRefreshDocument()">
                                    </ngx-entity-documents>
                                </ng-container>
                            </div>
                            <!-- Document End-->

                            <ng-container *ngIf="entityRelationComponents.length > 0">
                                <div class="tab-pane fade p-3 search-wrapper"
                                    [ngClass]="selectedTab == (tab.tabLink | removeWhiteSpace) ? 'show active' : ''"
                                    *ngFor="let tab of entityRelationTabs; let i = index" id="{{ tab.tabLink | removeWhiteSpace }}"
                                    role="tabpanel">
                                    <div class="table-responsive">
                                        <ng-container *ngIf="tab.isTabLoaded">
                                            <ngx-entity-relation [entityRelationComponent]="entityRelationComponents[i]" [entityId]="productId"
                                                [entityTypeId]="entityTypeId" [isShowToEntityAndAddEntity]="product.isActive && !product.isPaused"></ngx-entity-relation>
                                        </ng-container>
                                    </div>
                                </div>
                            </ng-container>

                        </div>
                    </form>
                    <!-- Tab Content END -->
                    <div *ngIf="isAdditionalTab">
                        <!-- Tab Additional here -->
                        <ng-container>
                            <ngx-globle-nav-tab [isNativeTab]="isNativeTab" [isAdditionalTab]="isAdditionalTab"
                                [navTabs]="navTabsMore" (setTab)="checkTabCall($event,0)" class="col-12 p-0" 
                                (closeTab)="closeNavTab($event)"
                                [ngClass]="{'edit-icon-section': isReadOnly && !(tabsNameHideAction | showHidePencilButton: activeTab)}"></ngx-globle-nav-tab>
                        </ng-container>
                    </div>
                    <!-- Tab Other Tabs Link -->
                </div>
            </div>
            <activity-section 
                [entityTypeId]="entityTypeId" 
                [entityId]="productId" 
                [isTagRequired]="true"
                [isEditPermission]="isEditProduct" 
                [isActive]="product.isActive"
                [isPaused]="product.isPaused"
                [isDocumentRequired]="true"
                [refreshDocument]="refreshDocument"
                [refreshActivity]="refreshActivity"
                [isDocumentDownloadPermission]="isDocumentDownloadPermission && product.isActive"
                [entityRecordTypeId]="entityRecordTypeId" 
                (isTagListUpdated)="setRefreshEntityTag()"
                (isFileDeleted)="setRefreshFileDeleted()" 
                (isActivityListUpdated)="setRefreshActivityHistory()" class="col-xl-4 col-md-12 common-box pr-0"
                [privacyLevel]="null"
                [createdBy]="product?.createdBy">
            </activity-section>


        </div>
    </div>
    <!-- Body End-->
</div>